"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[980],{31312:function(e,t,n){n.r(t),n.d(t,{_frontmatter:function(){return p},default:function(){return h}});var a=n(87462),r=n(63366),o=(n(67294),n(10498)),s=n(36904),i=["components"],p={},d={_frontmatter:p},l=s.Z;function h(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)(l,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Almost every night my wife and I play ",(0,o.kt)("a",{parentName:"p",href:"https://wordwormdormdork.com/"},"Weaver"),' together. It\'s always fun after\nseveral nights not finding the shortest "optimal" sequence of words it got me\nthinking. "How hard could it be to write an optimal Weaver solver?"'),(0,o.kt)("p",null,"So I made one. Here's how I did it."),(0,o.kt)("h2",{id:"step-1-getting-the-weaver-lexicon"},"Step 1: Getting the Weaver lexicon"),(0,o.kt)("p",null,"Weaver is based around finding a sequence of 4 letter words that each differ\nby one letter and lead to some final word."),(0,o.kt)("p",null,"The obvious first step to making a Weaver solver is to get all English 4\nletter words!"),(0,o.kt)("p",null,"I started by downloading an ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/dwyl/english-words"},"English dictionary on GH")," and filtered out all non\n4 letter words."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"wget https://github.com/dwyl/english-words/raw/master/words_alpha.txt -O /tmp/words.txt\nawk '{ if (length($0) == 5 ) print }' /tmp/words.txt | uniq > /tmp/4words.txt\nwc -l /tmp/4words.txt\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-text"},"7186 /tmp/4words.txt\n")),(0,o.kt)("p",null,"We see here that our lexicon is ",(0,o.kt)("inlineCode",{parentName:"p"},"7186")," words."),(0,o.kt)("h2",{id:"step-2-building-the-weaver-graph"},"Step 2: Building the Weaver graph"),(0,o.kt)("p",null,'The next step is to build a representation of the Weaver "solution space" that\nwe can work with to enable us to find the shortest word path.'),(0,o.kt)("p",null,"The simplest representation I could think of is a graph where the nodes are\nthe words, and the edges link words that have a 1 letter difference."),(0,o.kt)("p",null,"This representation is convenient because once we make it, we can run a\nshortest path graph algorithm (like Djikstra's) to get the optimal word path."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'def is_distance_one(word1, word2):\n    """If the words share 3 letters, they are distsance one"""\n    word1 = set((i, w) for i, w in enumerate(word1))\n    word2 = set((i, w) for i, w in enumerate(word2))\n    return len(set(word1).intersection(set(word2))) == 3\n\nweaver_graph = {}\nwith open(\'/tmp/4words.txt\', \'r\') as four_words:\n    for new_word in map(lambda w:w.strip(),four_words):\n        weaver_graph[new_word] = []\n        for existing_word, possible_next_words in weaver_graph.items():\n            if is_distance_one(new_word, existing_word):\n                weaver_graph[new_word].append(existing_word)\n                weaver_graph[existing_word].append(new_word)\n\nimport json\nwith open("/tmp/weaver_graph.json","w+") as f:\n    f.write(json.dumps(weaver_graph))\n')),(0,o.kt)("p",null,"This is a naive algorithm to create the graph, but it's simple, to the point,\nand we only have to run it once."),(0,o.kt)("p",null,"Now that the graph is built, let's try visualizing it!"),(0,o.kt)("p",null,(0,o.kt)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"2657px"}},"\n      ",(0,o.kt)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"53.56000000000001%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABSElEQVQoz12Sa4uCUBCG/f//qA9GCIGUpFhQBKvmhexitd28tLr77Bk5RC90GKZ5zsw7R6PrurZtf5Qk/hD51+vFqTOU/SoZZMuy/FZ6Pp91XTdNI9UfIvkJU52m6XK5nM/n4/E4SRLugteABGSqquIv6kkKb9zv9yiKVqvVZDIZjUa+72dZdrvd9AgiYjLAj8eDW8SjcTwe1+s1sOu6s9kMeLFYxHG82+0wIiOIc4FrJRneoM5xHNM0B4PBcDj0PC8IAkj6bzYbRpBpWYfYESOdknE+n8MwtG0b3rIsnLMCeoLt93sCfF0uF8oI9Np7mMuKoqA/PafTKTBtISmlJyf84XDQLjT5D/OjiDVQwaq/lJiFXUCSp2ee57i4Xq/6qfpty4ch8+DqdDptt1smhxG30pk88fsj97D+vETyqvJJcJZK78+r9Qc75m96Rn1ZwQAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}}),"\n  ",(0,o.kt)("picture",{parentName:"span"},"\n          ",(0,o.kt)("source",{parentName:"picture",srcSet:["/static/1dd2f625b877cb752e899f5cedac963a/a3bc4/weaver_graph.webp 2500w","/static/1dd2f625b877cb752e899f5cedac963a/e63b7/weaver_graph.webp 2657w"],sizes:"(max-width: 2657px) 100vw, 2657px",type:"image/webp"}),"\n          ",(0,o.kt)("source",{parentName:"picture",srcSet:["/static/1dd2f625b877cb752e899f5cedac963a/412e4/weaver_graph.png 2500w","/static/1dd2f625b877cb752e899f5cedac963a/370f5/weaver_graph.png 2657w"],sizes:"(max-width: 2657px) 100vw, 2657px",type:"image/png"}),"\n          ",(0,o.kt)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/static/1dd2f625b877cb752e899f5cedac963a/370f5/weaver_graph.png",alt:"img",title:"Full view of the Weaver word graph",loading:"lazy",decoding:"async",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.kt)("p",null,"This picture doesn't tell us much besides dense vs. not dense, but it's a\npretty picture nonetheless!"),(0,o.kt)("p",null,"If you want explore the graph for yourself,",(0,o.kt)("a",{href:"/img/weaver_graph.json"}," here is the JSON blob")," and",(0,o.kt)("a",{href:"/img/weaver_graph.svg"}," here is the SVG viz"),"."),(0,o.kt)("h2",{id:"step-3-building-the-weaver-solver"},"Step 3: Building the Weaver solver!"),(0,o.kt)("p",null,"Now that we have a graph of all the Weaver words and the transitions between\nthem, all we have left to do is build a solver!"),(0,o.kt)("p",null,"As mentioned we can now use a Djikstra's shortest path algorithm to find our\noptimal solution!"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'import json\nimport heapq\nfrom collections import namedtuple\nfrom dataclasses import dataclass\n\n@dataclass\nclass QueueItem:\n    node: str\n    path: list[str]\n    cost: int = 1\n\n    def __lt__(self, other):\n        return self.cost < other.cost\n\nclass WeaverSolver:\n    def __init__(self, weaver_graph_path: str):\n        self.weaver_graph = json.loads(open(weaver_graph_path,"r").read())\n\n    def solve(self, start_word: str, end_word: str, avoid_words: list[str] = None) -> list[str]:\n        assert start_word in self.weaver_graph, f"Start word {start_word} not in graph"\n        assert end_word in self.weaver_graph, f"End word {end_word} not in graph"\n\n        if not avoid_words:\n            avoid_words = []\n\n        init_queue_item = QueueItem(node=start_word, path=[], cost=0)\n        queue = [init_queue_item]\n        seen = set()\n\n        while True:\n            qi = heapq.heappop(queue)\n            if qi.node not in seen:\n\n                qi.path = qi.path + [qi.node]\n                seen.add(qi.node)\n\n                # if we are at the end, return the path\n                if qi.node == end_word:\n                    return qi.path\n\n                # search edges avoiding nodes and increasing cost\n                for search_node in self.weaver_graph[qi.node]:\n                    cost = float("inf") if search_node in avoid_words else qi.cost + 1\n                    heapq.heappush(\n                        queue,\n                        QueueItem(\n                            node=search_node,\n                            path=qi.path,\n                            cost=cost,\n                        )\n                    )\n\nsolver = WeaverSolver("/tmp/weaver_graph.json")\nprint(solver.solve("bone", "cast"))\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-text"},"['bone', 'bane', 'cane', 'cant', 'cast']\n")),(0,o.kt)("p",null,"And huzzah! We have a Weaver solver!"),(0,o.kt)("p",null,"Thanks for reading! ヾ(⌐■_■)ノ♪"))}h.isMDXComponent=!0}}]);
//# sourceMappingURL=component---content-posts-10-writing-a-weaver-solver-index-mdx-a4b97f51d0386c118248.js.map